;OCRed and translated from https://www.voja.rs/galaksija/ROM%20B%20Listing%20Scans/ROM_B_listing.htm
;NOT TESTED NOT COMPLETED

             00010 ;********************************************************
             00020 ;*                                                      *
             00030 ;*         "GALAKSIJA" ROM B                            *
             00040 ;*                                                      *
             00050 ;*                             VOJA ANTONIÄ† 12.07.84.   *
             00060 ;*                                                      *
             00070 ;********************************************************
             00080
             00090
005A         00100 SPACE    EQU     90
2A97         00110 SHOMEM   EQU     2A97H
2BB2         00120 SHOFOR   EQU     2BB2H
2BB3         00130 OPTION   EQU     2BB3H
2BD0         00140 FIELD    EQU     2BB6H+34
2BDD         00150 INS1     EQU     FIELD+5
2BDE         00160 INS2     EQU     INS1+1
2BE1         00170 INS3     EQU     INS2+3
2BE4         00180 IXIY     EQU     INS3+3
2BE5         00190 CODE     EQU     IXIY+1
2BEA         00200 ADDR     EQU     CODE+5
2BEC         00210 TEXTBR   EQU     ADDR+2
2BED         00220 TEMP1    EQU     TEXTBR+1
2BEF         00230 TEMP2    EQU     TEMP1+2
2AAA         00240 KRUG     EQU     2AAAH
2AAB         00250 FLAG2    EQU     2AABH
2BF2         00260 FREE     EQU     TEMP2+3
2BF4         00270 IXPOS2   EQU     FREE+2
2BF6         00280 DISPL    EQU     IXPOS2+2
2BB5         00290 FLAG     EQU     2BB5H
             00300
0B32         00310 PLUS     EQU     0B32H
0B1E         00320 MINUS    EQU     0B1EH
0AE6         00330 PUTA     EQU     0AE6H
0AF7         00340 KROZ     EQU     0AF7H
0B10         00350 CPIXIX   EQU     0B10H
             00360
1000         00370          ORG     1000H
             00380
1000 2A6A2A  00390          LD      HL,(2A6AH)    ; IF (ENDMEM)=0 THEN (ENDMEM)=0FFFFH
1003 7C      00400          LD      A,H
1004 B5      00410          OR      L
1005 2004    00420          JR      NZ,NOT56K     ; ENDMEM > 0
1007 2B      00430          DEC     HL            ; CORRECTED ENDMEM
1008 226A2A  00440          LD      (2A6AH),HL
100B 3E0C    00450 NOT56K   LD      A,0CH
100D 1813    00451          JR      GOINI
             00540
             00550
100F E3      00560 ZALINK   EX      (SP),HL
1010 D5      00570          PUSH    DE
1011 115B07  00580          LD      DE,75BH       ; THIS IS THE POSITION WHERE IT WOULD JUMP IF NOT...
1014 D7      00590          RST     10H           ; ...RECOGNIZED WORD IN BASIC PROGRAM
1015 201D    00600          JR      NZ,DRUGIP
1017 21F01D  00610          LD      HL,TEXT1-1    ; TABLE OF NEW WORDS
101A D1      00620          POP     DE
101B F1      00630 CASE1    POP     AF
101C C39A03  00640          JP      39AH          ; RECOGNIZE NEW WORD; IF IT DOESN'T EXIST IN TABLE...
101F C35B07  00650 KAO75B   JP      75BH          ; ...JUMP TO 10FH, THEN TO 75BH (SEE Z100)
             00651
1022 E7      00652 GOINI    RST     20H
1023 3E0C    00653          LD      A,0CH         ; NEW HORIZONTAL POSITION
1025 32AB2B  00654          LD      (2BABH),A
1028 21A110  00655          LD      HL,LINKS      ; INSERT JP INSTEAD OF RET IN LINKS
102B 11A92B  00656          LD      DE,2BA9H
102E 010600  00657          LD      BC,6
1031 EDB0    00658          LDIR                  ; INITIALIZATION OF ROM-A 2

1033 C9     00659         RET
            00660
1034 118E04 00670 DRUGIP  LD      DE,48EH         ; SECOND ATTEMPT: CHECK IF IT'S CORRECTLY RECOGNIZED...
1037 D7     00680         RST     10H             ; WORD 'PRINT', IF IT IS, CHECK WHAT FOLLOWS
1038 2013   00690         JR      NZ,TRECIP
103A D1     00700         POP     DE
103B E3     00710         EX      (SP),HL
103C F1     00720         POP     AF
103D DF     00730         RST     18H
103E 25     00740         DEFB    '%'
103F 0A     00750         DEFB    KAO48E-$-1
1040 CF     00760         RST     8
1041 3E20   00770         LD      A,' '        ; WRITE BLANK
1043 E7     00780         RST     20H
1044 CD4C13 00790         CALL    HEX16B      ; WRITE NUMBER IN HEX FORMAT
1047 C3AD04 00800         JP      4ADH
104A C38E04 00810 KAO48E JP      48EH        ; CONTINUES WHERE IT STARTED IF '%' DOESN'T FOLLOW
            00820
104D 117707 00830 TRECIP  LD      DE,777H     ; THIRD ATTEMPT: CHECK IF IT TRIED TO RECOGNIZE...
1050 D7     00840         RST     10H         ;  ...FUNCTION, BUT FAILED (777H IS ADDRESS...
1051 D1     00850         POP     DE          ;  ...TO WHICH IT WOULD JUMP IN THAT CASE)
1052 E3     00860         EX      (SP),HL
1053 C0     00870         RET     NZ
1054 21231E 00880         LD      HL,TEXT3-1  ; TABLE OF NEW FUNCTIONS
1057 18C2   00890         JR      CASE1       ; END IS SAME AS IN FIRST ATTEMPT
1059 C37707 00900 KAO777 JP      777H
            00910
105C 018004 00920 LPRINT  LD      BC,480H     ; 'LPRINT' ENTRY POINT: RET ADDRESS TO 'PRINT'
105F C5     00930         PUSH    BC          ; GOES TO STACK
1060 3EFF   00940 COPY    LD      A,0FFH      ; SETS LPRINT FLAG
1062 32B52B 00950         LD      (FLAG),A
1065 C9     00960         RET
            00970
1066 CD6010 00980 LLIST   CALL    COPY        ; 'LLIST' ENTRY POINT: SET FLAG
1069 CDD30C 00990         CALL    0CD3H       ; CONTINUE AS LLIST
106C C36404 01000         JP      464H
            01010
106F F5     01020 VIDEO   PUSH    AF          ; ADDITION TO SUBPROGRAM THAT WRITES CHARACTER TO...
1070 2AB52B 01030         LD      HL,(FLAG)   ; ...VIDEO MEM (958H, BUT HERE IS CHECKING...
1073 2C     01040         INC     L           ; IS THE FLAG FOR PRINTER SET?
1074 2021   01050         JR      NZ,NCOPY    ; IF NOT, EXIT
1076 21AB2A 01060         LD      HL,2AABH    ; CHECK IF FLAG IS SET TO NOT WRITE...
1079 CB46   01070         BIT     0,(HL)      ; ...CONTROL CHARS?
107B 200E   01080         JR      NZ,STAND    ; IF YES, SKIP CHARACTER CHANGE
107D 219910 01090         LD      HL,TABCZS   ; IF NOT, POINTER TO TABLE
1080 0604   01100         LD      B,4         ; TOTAL 4 CHARS FOR COMPARISON
1082 BE       01110 TEST4   CP      (HL)        ; IS THIS THE SEARCHED WORD?
1083 23       01120         INC     HL
1084 2804     01130         JR      Z,FOUND4    ; YES, JUMP
1086 23       01140         INC     HL
1087 10F9     01150         DJNZ    TEST4       ; TRY NEXT
1089 26       01160         DEFB    26H         ; AS 'LD H,ZEH' - TO SAVE MEMORY...
108A 7E       01170 FOUND4  LD      A,(HL)      ; ...SKIP NEXT WORD
108B F5       01180 STAND   PUSH    AF          ; ...SAVE NEW WORD
108C CDFF02   01190 RDY     CALL    2FFH        ; 'BREAK' TEST
108F DBFF     01200         IN      A,(255)
1091 17       01210         RLA
1092 38F8     01220         JR      C,RDY       ; JUMP IF PRINTER IS BUSY
1094 F1       01230         POP     AF
1095 D3FF     01240         OUT     (255),A     ; PRINTER FREE - SEND CHARACTER
1097 F1       01250 NCOPY   POP     AF
1098 C9       01260         RET
              01270
1099 5B       01280 TABCZS  DEFB    91         ; = C caron
109A 43       01290         DEFB    'C'
109B 5C       01300         DEFB    92          

109C 43       01310        DEFB    'C'         ; = C acute
109D 5D       01320        DEFB    93          
109E 5A       01330        DEFB    'Z'         ; = Z caron
109F 5E       01340        DEFB    94
10A0 53       01350        DEFB    'S'         ; = S caron
              01360
              01370
10A1 C3       01380 LINK   DEFB    0C3H
10A2 0F10     01390        DEFW    ZALINK      ; CHECK LINE 655 (C3H=JP)
10A4 C3       01400        DEFB    0C3H
10A5 6F10     0141         DEFW    VIDEO
              01420
10A7 2A9F2A   01430 GO4SS  LD      HL,(2A9FH)  ; ********** ASSEMBLER **********
10AA 7C       01440        LD      A,H         ; IS IT COMMAND MODE?
10AB B5       01450        OR      L
10AC CA5A06   01460        JP      Z,1626D     ; IF YES
10AF EB       01470        EX      DE,HL       ; MAIN POINTER WILL BE HL
10B0 3E01     01480        LD      A,1         ; SET OPT 1
10B2 32B32B   01490        LD      (OPTION),A
10B5 CDB610   01500        CALL    START1      ; CALL PROGRAM FOR ASSEMBLY
10B8 DD21AC2A 01510        LD      IX,2AACH    ; RETURN CORRECT VALUE IX REGISTER
10BC 2B       01520        DEC     HL
10BD EB       01530        EX      DE,HL       ; RETURN POINTER DE
10BE F7       01540        RST     30H         ; GO BACK TO BASIC
              01550
10BF AF       01560 START1 XOR     A
10C0 32AA2A   01570        LD      (KRUG),A    ; FIRST ASSEMBLY PASS
10C3 32DD2B   01580        LD      (INS1),A    ; EXECUTE OPCODE TOKEN
10C6 EB       01590        EX      DE,HL       ; SAVE HL IN DE
10C7 EF       01600        RST     28H         ; THIS IS LD HL,0
10C8 22F62B   01610        LD      (DISPL),HL
10CB 22972A   01620        LD      (SHOMEM),HL ; FOR 'REG'; SHOWS 0 BYTES OF MEMORY
10CE 2A6A2A   01630        LD      HL,(2A6AH)  ; = ENDMEM
10D1 2B       01640        DEC     HL
10D2 77       01650        LD      (HL),A      ; 0 = TERMINATOR TABLE FOR LABELS
10D3 2B       01660        DEC     HL
10D4 77       01670        LD      (HL),A
10D5 EB       01680        EX      DE,HL       ; RETURN HL
10D6 CD5217   01690        CALL    FINDCR      ; FIND END OF LINE WHERE IS '<'
10D9 E5       01700        PUSH    HL          ; SAVE POINTER FOR SECOND PASS
10DA CDE610   01710        CALL    ASS         ; FIRST ASSEMBLY PASS
10DD 21AA2A   01720        LD      HL,KRUG
10E0 34       01730        INC     (HL)        ; SET SECOND PASS
10E1 AF       01740        XOR     A
10E2 32DD2B   01750        LD      (INS1),A    ; EXECUTE OPCODES
10E5 E1       01760        POP     HL          ; RETURN POINTER TO START 1...
10E6 AF       01770 ASS    XOR     A           ; ...ENTER IN SECOND PASS
10E7 32EC2B   01780        LD      (TEXTBR),A  ; 0 WORDS IN TEXT
10EA 32EA2B   01790        LD      (ADDR),A    ; ERASE LABEL ADDRESS IN PROGRAM
10ED 32EB2B   01800        LD      (ADDR+1),A
10F0          01810 LOOP   EQU     $           ; FOLLOWING 13 LINES ARE MAIN LOOP
10F0 229F2A   01820        LD      (2A9FH),HL  ; POSITION OF CURRENT LINE(FOR ERROR CASE)
10F3 ED5B382C 01830        LD      DE,(2C38H)  ; END OF BASIC
10F7 D7       01840        RST     10H         
10F8 D0       01850        RET     NC          ; RETURN IF IT'S END AND NO '>'
10F9 3ADD2B   01860        LD      A,(INS1)
10FC FE08     01870        CP      8
10FE C8       01880        RET     Z           ; RETURN IF IT'S '>'
10FF CDFF02   01890        CALL    2FFH        ; 'BREAK' TEST
1102 CD3317   01900        CALL    PROG1       ; FIRST PART: PUTTING TOKEN IN TABLE
1105 E5       01910        PUSH    HL
1106 CD0C11   01920        CALL    PROG2       ; SECOND PART: CODE FORMING
1109 E1       01930        POP     HL
110A 18E4     01940        JR      LOOP        ; BACK TO MAIN LOOP
              01950
              01960

110C 214D12   01970 PROG2  LD      HL,GOON     ; THIS IS RET ADDRESS FOR END OF SUBROUTINE
110F E5       01980        PUSH    HL
1110 21DE2B   01990        LD      HL,INS2
1113 DD21DB2B 02000        LD      IX,FIELD+3
1117 3ADD2B   02010        LD      A,(INS1)
111A B7       02020        OR      A
111B C8       02030        RET     Z           ; NOTHING IN THIS LINE - GO TO GOON
111C FE09     02040        CP      9           ; IS IT SPECIAL WORD (TOKEN=9)
111E D22413   02050        JP      NC,NCOMM    ; NO - NEXT WORD FOR ASSEMBLY
1121 3D       02060        DEC     A
1122 2027     02070        JR      NZ,NSTAT    ; NOT TOKEN 1
1124 217819   02080        LD      HL,BRKPT    ; TOKEN 1: 'REG' (BREAKPOINT)
1127 22E62B   02090        LD      (CODE+1),HL ; BREAKPOINT ADDRESS
112A 3ECD     02100        LD      A,0CDH      ; CODE FOR 'CALL'
112C 32E52B   02110        LD      (CODE),A
112F 3E03     02120        LD      A,3
1131 32E92B   02130        LD      (CODE+4),A  ; 3 BYTES CODED LENGTH
1134 2ADF2B   02140        LD      HL,(INS2+1) ; IS THERE MEMORY DISPLAY?
1137 7C       02150        LD      A,H
1138 B5       02160        OR      L
1139 C8       02170        RET     Z           ; NO - GO TO GOON
113A CD1813   02180        CALL    IFNUM2      ; IS IT NUMERIC VALUE (IF NOT-WHAT?)
113D 22972A   02190        LD      (SHOMEM),HL ; SHOW HL MEMORY
1140 3AE22B   02200        LD      A,(INS3+1)  ; HOW MANY ROWS?
1143 B7       02210        OR      A
1144 2001     02220        JR      NZ,IMA      ; NUMBER OF ROWS SPECIFIED
1146 3C       02230        INC     A           ; NOT SPECIFIED - THEN 1 ROW
1147 32B22B   02240 IMA    LD      (SHOFOR),A  ; = SHOW FORMAT
114A C9       02250        RET
              02260
114B 3D       02270 NSTAT  DEC     A
114C 2021     02280        JR      NZ,NTEXT    ; NOT TOKEN 2
114E 7E       02290        LD      A,(HL)      ; TOKEN 2: 'TEXT'
114F 32EC2B   02300        LD      (TEXTBR),A  ; NUMBER OF TEXT WORDS
1152 11E52B   02310        LD      DE,CODE
1155 0603     02320 TEXTIT LD      B,3         ; 3 BYTES IN ONE ROW
1157 3AEC2B   02330 TXT4   LD      A,(TEXTBR)  ; HOW MANY WORDS LEFT?
115A B7       02340        OR      A
115B C8       02350        RET     Z           ; NONE - GO TO GOON
115C DD3511   02360        DEC     (IX+17)     ; DECREASE WORD COUNT
115F 2ADF2B   02370        LD      HL,(INS2+1) ; TEXT ADDRESS IN PROGRAM
1162 7E       02380        LD      A,(HL)      ; TAKE WORD OR CHARACTER
1163 23       02390        INC     HL          ; INCREASE POINTER
1164 22DF2B   02400        LD      (INS2+1),HL ; AND RETURN IT
1167 12       02410        LD      (DE),A      ; PUT CHARACTER IN CODE
1168 13       02420        INC     DE          ; INCREASE CODE POINTER
1169 DD348E   02430        INC     (IX+14)     ; INCREASE BYTE COUNT
116C 10E9     02440        DJNZ    TXT4        ; DO THIS 3 TIMES IN EACH ROW
116E C9       02450        RET                 ; GO TO GOON
116F 3D       02460 NTEXT  DEC     A
1170 2004     02470        JR      NZ,NWORD    ; NOT TOKEN 3
1172 3C       02480        INC     A           ; TOKEN 3: 'WORD'
1173 DD770E   02490        LD      (IX+14),A   ; BYTE COUNT=1 (AND ON 5120 WILL BE +1)
1176 3D       02500 NWORD  DEC     A
1177 200C     02510        JR      NZ,NBYTE    ; NOT TOKEN 4 OR 3
1179 CD1813   02520        CALL    IFNUM1      ; TOKEN 4: 'BYTE'
117C 2ADF2B   02530        LD      HL,(INS2+1) ; TAKE CODE
117F 22E52B   02540        LD      (CODE),HL   ; PUT IT IN ITS PLACE
1182 C34813   02550        JP      IXGOON      ; SEE 5120
              02560
1185 3D       02570 NBYTE  DEC     A
1186 2023     02580        JR      NZ,NOPT     ; NOT TOKEN 5
1188 CD1813   02590        CALL    IFNUM2      ; TOKEN 5: 'OPT' (IF >255, WHAT)
118B 2ADF2B   02600        LD      HL,(INS2+1) ; TAKE NUMBER OPTION
118E 7D       02610        LD      A,L         ; U A REG
118F E604     02620        AND     4           ; IF BIT 2 IS SET (4-5-6-7)
;new page
1191 C46810   02630       CALL NZ,COPY      ; SET FLAG FOR PRINTER
1194 7D       02640       LD A,L
1195 E603     02650       AND 3
1197 32B32B   02660       LD (OPTION),A   ; MASK TO BE LESS THAN 4
119A 3AE12B   02670       LD A,(INS3)
119D B7       02680       OR A            ; IS RELOCATION REQUESTED ON WRITE?
119E C8       02690       RET Z           ; NO - GO TO GOON
119F FE40     02700       CP 40H
11A1 C22D19   02710       JP NZ,WHATHL    ; NOT NUMERIC - ERROR
11A4 2AE22B   02720       LD HL,(INS3+1)  ; RELOCATION SIZE...
11A7 22F62B   02730       LD (DISPL),HL   ; ...TO ITS PLACE
11AA C9       02740       RET

11AB 3D       02760 NOPT  DEC A
11AC 2000     02770       JR NZ,NORG      ; NOT TOKEN 6
11AE CD1813   02780       CALL IFNUM1     ; TOKEN 6: 'ORG'
11B1 2ADF2B   02790       LD HL,(INS2+1)
11B4 22ED2B   02800       LD (TEMP1),HL   ; TEMPORARY ADDRESS
11B7 22EA2B   02810       SKR4 LD (ADDR),HL ; MAIN POINTER OF PC ADDRESS
11BA C9       02820       RET

11BB 3D       02850 NORG DEC A
11BC C0       02860       RET NZ          ; END = TOKEN 8 '>'
11BD CD1813   02870       CALL IFNUM1     ; TOKEN 7: 'EQU'
11C0 ED4BDF2B 02880       LD BC,(INS2+1)
11C4 ED43ED2B 02890       LD (TEMP1),BC  ; LABEL ADDRESS
11C8 CDD211   02900       CALL CREATE     ; FORM LABEL
11CB CA2D19   02910       JP Z,WHATHL     ; IF NOT PROVIDED - WHAT
11CE F1       02920       POP AF          ; RESTORE STACK - WON'T GO TO GOON
11CF C35412   02930       JP GOON1        ; BUT TO GOON1

11D2 3AAA2A   02960 CREATE LD A,(KRUG) ; ---- LABEL FORMATION ----
11D5 B7       02970       OR A
11D6 C0       02980       RET NZ          ; CANNOT BE FORMED IN SECOND PASS
11D7 2ADA2B   02990       LD HL,(FIELD+2)
11DA 7C       03000       LD A,H
11DB B5       03010       OR L
11DC C8       03020       RET Z           ; RETURN IF LABEL ADDRESS DOESN'T EXIST
11DD CD1512   03030       CALL LOCAT2     ; CHECK IF IT'S ALREADY FORMED
11E0 CA4F16   03040       JP Z,HOWHL      ; IF IT EXISTS - CANNOT BE FORMED TWICE (HOW?)

11E3 E5       03050 TRANSF PUSH HL
11E4 2A382C   03060 LD HL,(2C38H)   ; END OF BASIC PROGRAM
11E7 D7       03070 RST 10H
11E9 E1       03080 POP HL
11E9 D25301   03090 JP NC,339D      ; SORRY - NO MEMORY
11EC 7E       03100 LD A,(HL)
11ED 12       03110 LD (DE),A       ; TRANSFER LETTER BY LETTER TO TABLE
11EE 23       03120 INC HL
11EF 1B       03130 DEC DE
11F0 CD5818   03140 CALL NCSLBR     ; IF LETTER OR NUMBER
11F3 30EE     03150 JR NC,TRANSF    ; ...CONTINUE WITH TRANSFER
11F5 EB       03160 NOTRAN EX DE,HL
11F6 23       03170 INC HL
11F7 CBFE     03180 SET 7,(HL)      ; WORD TERMINATOR = BIT 7 SET
11F9 2B       03190 DEC HL
11FA 72       03200 LD (HL),B       ; BC = LABEL VALUE
11FB 2B       03210 DEC HL
11FC 71       03220 LD (HL),C
11FD 2B       03230 DEC HL
11FE 3600     03240 LD (HL),0       ; TABLE TERMINATOR
1200 EB       03250 EX DE,HL        ; HL = POINTER NOW BEHIND NAME
1201 AF       03260 XOR A           ; RESET Z FLAG (SIGN THAT EVERYTHING IS OK)
1202 3C       03270 INC A           ; NEW POSITION IN TABLE
1203 C9       03280 RET
;new page
1204 3AAA2A   03300 LOCATE  LD    A,(KRUG)    ; ---- LOOP LABEL ----
1207 B7       03310         OR    A
1208 200B     03320         JR    NZ,LOCAT2   ; ONLY IN SECOND LOOP
120A 2B       03330         DEC   HL          ; AND IN 1. LOOP JUST SKIP NAME
120B 23       03340 SRC20H  INC   HL
120C CD5018   03350         CALL  NCSLBR
120F 30FA     03360         JR    NC,SRC20H
1211 AF       03370         XOR   A
1212 47       03380         LD    B,A
1213 4F       03390         LD    C,A
1214 C9       03400         RET
              03410
1215 E5       03420 LOCAT2  PUSH  HL
1216 D9       03430         EXX
1217 2A6A2A   03440         LD    HL,(2A6AH)  ; END OF MEMORY (START OF COMPARISON)
121A 2B       03450         DEC   HL
121B 1812     03460         JR    IFF1R       ; START
121D D1       03470 GOSRCH  POP   DE          ; RECONSTRUCT POINTER
121E D5       03480         PUSH  DE
121F 1A       03490 GOSRC2  LD    A,(DE)      ; TAKE FROM PROGRAM TEXT
1220 BE       03500         CP    (HL)        ; AND COMPARE WITH LABEL LIST
1221 2816     03510         JR    Z,FOUNDV    ; ONE WORD MATCHES
1223 F680     03520         OR    80H         ; SET BIT 7 (AS IN THE LAST CHARACTER)
1225 BE       03530         CP    (HL)        ; AND COMPARE AGAIN (MAYBE IT'S THE END)
1226 2815     03540         JR    Z,BASFDU    ; STILL - SUCCESSFUL COMPARISON
1228 CB7E     03550 SRCHV   BIT   7,(HL)      ; NO - FIND END OF THIS NAME IN LIST
122A 2B       03560         DEC   HL
122B 28FB     03570         JR    Z,SRCHV     ; NOT THE END YET
122D 2B       03580         DEC   HL          ; SKIP VALUE IN LIST
122E 2B       03590         DEC   HL          ; ONE MORE BYTE
122F 7E       03600 IFF1R   LD    A,(HL)      ; NEXT NAME (FIRST CHARACTER)
1230 B7       03610         OR    A           ; MAYBE IT'S NULL (TERMINATOR TABLE)?
1231 20EA     03620         JR    NZ,GOSRCH   ; NO - CONTINUE COMPARISON
1233 E5       03630         PUSH  HL          ; TRANSFER HL TO DE
1234 D9       03640         EXX               ; ...OF ALTERNATIVE SET
1235 D1       03650         POP   DE          ; DE = NEW POSITION IN TABLE
1236 E1       03660         POP   HL          ; RECONSTRUCT HL
1237 3C       03670         INC   A           ; A=1 (SIGN THAT NAME NOT FOUND)
1238 C9       03680         RET
1239 2B       03690 FOUNDV  DEC   HL          ; COMPARISON GOING WELL
123A 13       03700         INC   DE          ; GO TO NEW CHARACTER
123B 18E2     03710         JR    GOSRC2      ; CONTINUE COMPARISON
123D 13       03720 BASFDU  INC   DE          ; GO TO NEW CHARACTER IN PROGRAM
123E EB       03730         EX    DE,HL
123F CD5018   03740         CALL  NCSLBR      ; IF IT'S WORD OR NUMBER, RESET CARRY
1242 EB       03750         EX    DE,HL
1243 30E3     03760         JR    NC,SRCHV    ; SO SAY LONG-NO SUCCESSFUL COMPARISON
1245 2B       03770         DEC   HL          ; FULLY SUCCESSFUL COMPARISON; GO TO VALUE
1246 46       03780         LD    B,(HL)      ; HIGH BYTE
1247 2B       03790         DEC   HL
1248 4E       03800         LD    C,(HL)      ; BC = VALUE
1249 EB       03810         EX    DE,HL       ; HL = POINTER TO NAME
124A D1       03820         POP   DE          ; DE = START POINTER
124B AF       03830         XOR   A           ; A = 0 (SIGN THAT NAME IS FOUND IN LIST)
124C C9       03840         RET
              03850
              03860
124D ED4BEA2B 03870 GOON    LD    BC,(ADDR)   ; ---- END OF PROCESSING ONE WORD ----
1251 CDD211   03880         CALL  CREATE      ; CREATE NEW LABEL IF EXISTS
1254 11E42B   03890 GOON1   LD    DE,IXIY     ; DE POINTS TO IXIY FLAG IN RAM-U
1257 1A       03900         LD    A,(DE)
1258 B7       03910         OR    A           ; IS THERE SOMETHING HERE?
1259 200B     03920         JR    NZ,IMAGA    ; JUMP IF INSTRUCTION REFERS TO IX OR IY
125B 21E52B   03930         LD    HL,CODE     ; NO - CHECK CODE FOR ONE POSITION LOWER
125E 010400   03940         LD    BC,4
;new page
1261 EDB8     03950         LDIR
1263 12       03960         LD    (DE),A      ; PUT NULL IN LAST BYTE
1264 1817     03970         JR    PRES1
1266 FEED     03980 IMAGA   CP    0EDH        ; IS IT 0EDH?
1268 2813     03990         JR    Z,PRES1     ; IF YES-THEN NEITHER IX NOR IY
126A 21E92B   04000         LD    HL,FIELD+17 ; HL POINTS TO NUMBER OF BYTES THAT
126D 34       04010         INC   (HL)        ; INCREASES IT
126E DD7E03   04020         LD    A,(IX+3)    
1271 FE86     04030         CP    86H         ; IS THE OPERAND 1...
1273 2805     04040         JR    Z,F1        ; ...IX IN BRACKETS?
1275 DD7E06   04050         LD    A,(IX+6)    ; IF YES JUMP
1278 FE86     04060         CP    86H         ; OR MAYBE OPERAND 2...
127A CCF71F   04070 F1      CALL  Z,EXTRA     ; ...IX IN BRACKETS?
              04080                           ; IF YES CALL EXTRA SERVICE
127D DD460E   04090 PRES1   LD    B,(IX+14)
1280 04       04100         INC   B
1281 05       04110         DEC   B           ; IF IT'S NULL, SKIP
1282 CA1013   04120         JP    Z,NEMABY
1285 2AEA2B   04130         LD    HL,(ADDR)   ; TAKE PROGRAM COUNTER
1288 CD5713   04140         CALL  HEX16       ; WRITE VALUE
128B 3E20     04150         LD    A,' '       ; BLANK
128D CD7013   04160         CALL  ZAPRIN
1290 11E42B   04170 PRVIK1  LD    DE,IXIY
1293 3AAA2A   04180 PUTABY  LD    A,(KRUG)
1296 B7       04190         OR    A           ; WHICH ASSEMBLY PASS IS THIS
1297 2820     04200         JR    Z,PRVIK     ; IF FIRST - SKIP
1299 C5       04210         PUSH  BC
129A 45       04220         LD    B,L         ; B = LOW BYTE OF PROGRAM COUNTER
129B 0EFD     04230         LD    C,253       ; OUTPUT ADDRESS FOR HIGH BYTE
129D ED61     04240         * OUT  (C),H      ; HIGH BYTE GOES TO LATCH EMULATOR
129F 0C       04250         INC   C           ; NEW OUTPUT ADDRESS
12A0 3AB32B   04260         LD    A,(OPTION)
12A3 E602     04270         AND   2
12A5 1A       04280         LD    A,(DE)      ; TAKE BYTE CODE
12A6 ED79     04290         * OUT  (C),A      ; SEND TO EMULATOR
12A8 C1       04300         POP   BC
12A9 280A     04310         JR    Z,NOWMR     ; IF SELECTED OPTION DOESN'T REQUIRE WRITING...
12AB E5       04320         PUSH  HL          ; ...TO MEMORY - SKIP
12AC D5       04330         PUSH  DE
12AD ED5BF62B 04340         LD    DE,(DISPL)  ; IS THERE RELOCATION WRITING?
12B1 19       04350         ADD   HL,DE       ; ADD RELOCATION VALUE
12B2 77       04360         LD    (HL),A      ; ****** WRITE BYTE TO MEMORY ******
12B3 D1       04370         POP   DE
12B4 E1       04380         POP   HL
12B5 CD5C13   04390 NOWMR   CALL  HEX8        ; PRINT BYTE ON SCREEN
12B8 13       04400         INC   DE
12B9 23       04410 PRVIK   INC   HL          ; INCREASE POINTERS
12BA 10D7     04420         DJNZ  PUTABY      ; RETURN AS MANY TIMES AS YOU HAVE BYTES
12BC 22EA2B   04430         LD    (ADDR),HL   ; NEW ADDRESS OF PROGRAM COUNTER
12BF 3AEC2B   04440         LD    A,(TEXTR)   ; IS THERE ANY CODE TEXT?
12C2 B7       04450         OR    A
12C3 2811     04460         JR    Z,NEMAB1    ; IF NOT - JUMP
12C5 3E0D     04470         LD    A,0DH       ; IMA - NEW LINE
12C7 CD7013   04480         CALL  ZAPRIN
12CA DD360E00 04490         LD    (IX+14),0   ; NUMBER OF BYTES = 0
12CE 11E42B   04500         LD    DE,CODE-1   ; TAKE NEW 3 BYTES OF TEXT
12D1 CD5511   04510         CALL  TEXTIT
12D4 18A7     04520         JR    PRES1       ; CONTINUE IF WORKING WITH TEXT
12D6 3AAA2A   04530 NEMAB1  LD    A,(KRUG)
12D9 B7       04540         OR    A
12DA C8       04550         RET   Z           ; RETURN IF IT'S FIRST PASS
12DB 3AB32B   04560         LD    A,(OPTION)
12DE 1F       04570         RRA
12DF D0       04580         RET   NC          ; RETURN IF PRINTING IS NOT REQUIRED
12E0 3A682A   04590 GOBL    LD    A,(2A68H)   ; CURSOR POSITION
12E3 E61F     04600         AND   1FH         ; TAKE ONLY POSITION IN LINE
;new page
12E5 FE0B     04610         CP    0BH         ; IS IT LESS THAN 11
12E7 3805     04620         JR    NC,VEC11    ; NO - SKIP
12E9 3E20     04630         LD    A,20H       ; BLANK
12EB E7       04640         RST   20H
12EC 18F2     04650         JR    GOBL        ; WRITE BLANKS UNTIL YOU REACH TAB(11)
12EE ED5B9F2A 04660 VEC11   LD    DE,(2A9FH)  ; TAKE POSITION OF CURRENT LINE
12F2 CD6F19   04670         CALL  RELIX1      ; PREPARE IX FOR ARITHMETIC
12F5 3AB32B   04680         LD    A,(OPTION)  ; WHICH OPTION?
12F8 1F       04690         RRA
12F9 3010     04700         JR    NC,RELIX2   ; IF NOT PRINT TO SCREEN
12FB CDED08   04710         CALL  08EDH       ; WRITE PROGRAM LINE NUMBER
12FE 3AD82B   04720         LD    A,(FIELD+3) ; IS THERE A LABEL?
1301 B7       04730         OR    A
1302 2004     04740         JR    NZ,UVUCI    ; EXISTS - LEAVE CURSOR WHERE IT IS
1304 3E20     04750         LD    A,' '       ; BLANK
1306 E7       04760         RST   20H         ; ONCE
1307 E7       04770         RST   20H         ; TWICE
1308 CD3409   04780 UVUCI   CALL  934H        ; WRITE PROGRAM LINE TEXT
130B DD2AF42B 04790 RELIX2  LD    IX,(IXPOS2) ; RESTORE OLD IX
130F C9       04800         RET               ; FINISHED WITH LINE PROCESSING
1310 2AE02B   04810 NEMABY  LD    HL,(TEMP1)  ; ONLY PROGRAM COUNTER
1313 CD5713   04820         CALL  HEX16       ; WRITE IT
1316 18BE     04830         JR    NEMAB1      ; AND WRITE LINE NUMBER AND TEXT
              04840
1318 CD9314   04850 IFNUM1  CALL  TEST3       ; ** IF THERE IS SECOND OPERAND...
131B 3ADE2B   04880 IFNUM2  LD    A,(INS2)    ; ...OR FIRST IS NOT NUMERIC...
131E FE40     04890         CP    40H         ; ...THEN WHAT
1320 C8       04900         RET   Z           ; ** IF FIRST OPERAND IS NOT...
1321 C32D19   04910 ZASN    JP    WHATHL      ; ...NUMERIC - THEN WHAT
              04920
1324 3D       04930 NCOMM   DEC   A           ; CHECK IF IT'S A SIMPLE INSTRUCTION...
1325 4F       04940         LD    C,A
1326 FE2A     04950         CP    2AH         ; ...(GROUP 2) ILI ED+ (GROUP3)
1328 D28213   04960         JP    NC,CBPLUS   ; IF NOT ONE OR THE OTHER, GO ON
132B 0606     04970         LD    B,6         ; TEST 6 BYTES
132D AF       04980         XOR   A           ; IN GROUP 'INS2' AND 'INS3'
132E B6       04990 XX6     OR    (HL)
132F 23       05000         INC   HL
1330 10FC     05010         DJNZ  XX6         ; IF ANY OPERAND EXISTS
1332 20ED     05020         JR    NZ,ZASN     ; THEN GO TO WHAT
1334 79       05030         LD    A,C
1335 FE15     05040         CP    15H         ; IS IT ED+
1337 3807     05050         JR    C,NOED      ; IF NOT SKIP
1339 DD360F0D 05060         LD    (IX+9),0EDH ; STORE ED
133D DD340E   05070         INC   (IX+14)     ; INCREASE NUMBER OF BYTES
1340 21761E   05080 NOED    LD    HL,TABY1-8  ; FIND CODED BYTE IN TABLE
1343 09       05090         ADD   HL,BC       ; ...COLLECTION...
1344 7E       05100         LD    A,(HL)      ; TAKE IT FROM TABLE
1345 DD770A   05110         LD    (IX+10),A   ; AND PUT IT IN ITS PLACE
1348 DD340E   05120 IXGOON  INC   (IX+14)     ; INCREASE NUMBER OF BYTES
134B C9       05130         RET               ; DONE
134C 3E26     05150 HEX16B  LD    A,'&'       ; ****** WRITE IN HEX FORMAT HL UNCONDITIONALLY
134E E7       05160         RST   20H         ; FIRST WRITE CHARACTER '&' IN HEX NUMBER
134F 3E01     05170         LD    A,1         ; SET PRINTING CONDITIONS
1351 32B32B   05180         LD    (OPTION),A
1354 32AA2A   05190         LD    (KRUG),A
1357 7C       05200 HEX16   LD    A,H         ; ****** WRITE IN HEX FORMAT HL CONDITIONALLY
1358 CD5C13   05210         CALL  HEX8        ; FIRST HIGH BYTE
135B 7D       05220 HEX8L   LD    A,L         ; ****** WRITE IN HEX FORMAT L CONDITIONALLY
135C 4F       05230 HEX8    LD    C,A         ; ****** WRITE IN HEX FORMAT A CONDITIONALLY
135D E6F0     05240         AND   0F0H        ; MASK UPPER 4 BITS
135F CD3714   05250         CALL  RLC4        ; ROTATE AND PUT IN LOWER 4
1362 CD6813   05260         CALL  HCONV       ; CONVERT TO HEX DIGIT (0-9; A-F) AND WRITE
1365 79       05270         LD    A,C
1366 E60F     05280         AND   0FH         ; AND SAME FOR LOWER 4 BITS
;newpage
1368 C630    05290 HCONV  ADD    A,30H      ; CONVERTS TO ASCII CHARACTER
136A FE3A    05300        CP     3AH        ; ABOVE 9?
136C 3802    05310        JR     C,ZAPRIN   ; NO - SKIP
136E C807    05320        ADD    A,7        ; IF YES ADD 7 (TO A-F)
1370 F5      05330 ZAPRIN PUSH   AF
1371 3AAA2A  05340        LD     A,(KRUG)   ; TEST FIRST CONDITION
1374 B7      05350        OR     A          ; WHICH IS ROUND?
1375 2806    05360        JR     Z,RETK1    ; IF FIRST - DON'T CONTINUE
1377 3AB32B  05370        LD     A,(OPTION) ; TEST SECOND CONDITION
137A 1F      05380        RRA              ; WHICH OPTION?
137B 3802    05390        JR     C,NORET1   ; IF PRINTING IS REQUESTED - SKIP
137D F1      05400 RETK1  POP    AF
137E C9      05410        RET
137F F1      05420 NORET1 POP    AF
1380 E7      05430        RST    20H        ; WRITE CHARACTER TO SCREEN AND...
1381 C9      05440        RET               ; ...POTENTIALLY TO PRINTER             
1382         05450
1382 CBFLUS  05460        EQU    $
1382 CD0517  05470        CALL   IXIYHL     ; SAVE IX IY OR HL DEPENDING ON HL
1385 79      05480        LD     A,C
1386 0600    05490        LD     B,0
1388 FE34    05500        CP     34H        ; IS IT GROUP 4 (CB+)
138A D2D613  05510        JP     NC,GRUPA5  ; IF NOT CONTINUE
138D 21351E  05520        LD     HL,TAB4-2AH; ELSE - POINT TO TABLE
1390 09      05530        ADD    HL,BC      ; CALCULATE POSITION
1391 46      05540        LD     B,(HL)     ; GET CODE
1392 DD360ACB 05550        LD     (IX+10),0CBH   ; FIRST BYTE: CB
1396 DD770B  05560        LD     (IX+11),B  ; SECOND BYTE: FROM TABLE
1399 DD36OE02 05570        LD     (IX+14),2 ; NUMBER OF BYTES: 2
139D 21E12B  05580        LD     HL,INS3
13A0 FE31    05590        CP     31H        ; SOME OF CB+ INSTRUCTIONS DON'T HAVE...
13A2 381A    05600        JR     C,NOBIT    ; ...NUMERIC FIELD
13A4 CDD616  05610        CALL   ZAINS2     ; GET NUMERIC FIELD WITH ALL TESTS
13A7 FE08    05620        CP     8          ; FOR BIT/SET/RES; IF BIT>7
13A9 D24F16  05630        JP     NC,HOWHL   ; THEN IT'S AN ERROR
13AC 07      05640        RLCA              ; ROTATE NUMBER OF BITS INTO YOUR FIELD
13AD 07      05650        RLCA
13AE 07      05660        RLCA
13AF DD860B  05670        OR     (IX+11)    ; AND PUT IT IN CODE
13B2 DD770B  05680        LD     (IX+11),A
13B5 1808    05690        JR     RHLIXY     ; CHECK WHICH REGISTER IT IS
             05700
13B7 7E      05710 NOBIT  LD     A,(HL)     ; WE SAID THERE'S NO NUMERIC FIELD
13B8 B7      05720        OR     A          ; ...AND HERE IT IS; SO ERROR
13B9 C22D19  05730 WHATNZ JP     NZ,WHATHL  ; WHICH REGISTER (BCDEHL)A
13BC 21DE2B  05740        LD     HL,INS2
13BF CDE616  05750 RHLIXY CALL   KOJR2
13C2 DD860B  05760 SKRLD  OR     (IX+11)    ; PUT IT IN CODE
13C5 DD770B  05770        LD     (IX+11),A
13C8 23      05780        INC    HL
13C9 6E      05790        LD     L,(HL)
13CA 3AE42B  05800        LD     A,(IXIY)   ; IS THIS THE SAVED IX/IY CASE?
13CD B7      05810        OR     A
13CE C8      05820        RET    Z          ; NO - RETURN
13CF DD660B  05830        LD     H,(IX+11)  ; YES - THEN 2-BYTE CODE
13D2 22E62B  05840 ZAGOHL LD     (CODE+1),HL
13D5 C9      05850        RET
             05860
13D6 FE3C    05870 GRUPA5 CP     3CH        ; IS IT GROUP 5 (ARITHMETIC GROUP)
13D8 DD360E01 05880        LD     (IX+14),1
13DC D26314  05890        JP     NC,GRUPA6  ; NO - CONTINUE
13DF 21361E  05900        LD     HL,TAB5-34H; TABLE OF GROUP 5
13E2 09      05910        ADD    HL,BC      ; CALCULATE POSITION IN TABLE
13E3 5E      05920        LD     E,(HL)     ; GET CODE INTO E REGISTER
13E4 21DE2B  05930        LD     HL,INS2
13E7 7E      05940        LD     A,(HL)
; new page
13E8 FE06    05950        CP     6          ; IS HL IN PARENTHESES?
13EA 2850    05960        JR     Z,HL16     ; YES - THEN SPECIAL PROCESSING
13EC 3AE12B  05970        LD     A,(INS3)
13EF B7      05980        OR     A          ; IS THERE A SECOND OPERAND?
13F0 2808    05990        JR     Z,PRESK3   ; NO - SKIP ITS PROCESSING
13F2 7E      06000        LD     A,(HL)     ; IS THIS THE FIRST OPERAND?
13F3 FE0E    06010        CP     0EH        ; IS IT 'A'?
13F5 28C2    06020        JR     NZ,WHATNZ  ; IF NOT - ERROR
13F7 21E12B  06030        LD     HL,INS3    ; POINT TO OPER 3
13FA 7E      06040 PRESK3 LD     A,(HL)
13FB FE40    06050        CP     40H        ; NUMBER WITHOUT PARENTHESES?
13FD 281F    06060        JR     Z,NUMLOG   ; YES - SPECIAL PROCESSING
13FF CDE616  06070        CALL   KOJR2      ; WHICH REGISTER
1402 B3      06080        OR     E          ; PUT IN CODE
1403 23      06090 ADJUST INC    HL
1404 DD770A  06100 ADJ1   LD     (IX+10),A  ; FIRST BYTE OF CODE
1407 7E      06110        LD     A,(HL)
1408 DD770B  06120        LD     (IX+11),A  ; SECOND BYTE OF CODE
140B C9      06130        RET
             06140
140C DD340E  06150 SUB    INC    (IX+14)    ; INCREMENT NUMBER OF BYTES
140F 23      06160        INC    HL
1410 23      06170        INC    HL         ; HL POINTS TO HIGH BYTE OF NUMBER
1411 3AAA2A  06180        LD     A,(KRUG)
1414 B7      06190        OR     A          ; WHICH ROUND?
1415 2805    06200        JR     Z,NEU1     ; FIRST - THEN DON'T CHECK FOR ERROR
1417 7E      06210        LD     A,(HL)
1418 B7      06220        OR     A
1419 C24F16  06230        JP     NZ,HOWHL   ; GREATER THAN 255; THUS OVERFLOW
141C 2B      06240 NEU1   DEC    HL         ; POINT TO LOW BYTE
141D C9      06250        RET
             06260
141E CD0C14  06270 NUMLOG CALL   SUB        ; OVERFLOW TEST
1421 7B      06280        LD     A,E
1422 F646    06290        OR     46H        ; REWORK CODE
1424 18DE    06300        JR     ADJ1       ; PUT IT IN PLACE FOR CODES
             06310
1426 1E01    06320 PARREG LD     E,1        ; *** TESTS WHICH REGISTER OR...
1428 CDED16  06330        CALL   RTEST      ; ...PAIR OF REGISTERS AND FORMS MICROCODE
142B 3008    06340        JR     NC,RLC3    ; NC MEANS IT'S 8-BIT REGISTER
142D 1C      06350        INC    E          ; HERE IT'S 16-BIT PAIR
142E 7E      06360 KOJPAR LD     A,(HL)
142F FE08    06370 KOP1   CP     8          ; MORE THAN 8 ARE 8-BIT REGISTERS
1431 3008    06380        JR     NC,WHATNC  ; SO THIS IS AN ERROR
1433 D604    06390        SUB    4          ; SUBTRACT 4 FOR IX/IY/AF
1435 3861    06400        JR     C,SKWHAT   ; AND WITH THEM NO ARITHMETIC...
1437 07      06410 RLC4   RLCA              ; ...OPERATIONS
1438 07      06420 RLC3   RLCA
1439 07      06430        RLCA
143A 07      06440        RLCA
143B C9      06450        RET
             06460
143C 79      06470 HL16   LD     A,C        ; 16-BIT OPERATIONS WITH HL REGISTER
143D FE37    06480        CP     37H        ; IS IT 'SUB' INSTRUCTION?
143F 3057    06490 WHATNC JR     NC,SKWHAT  ; YES - BUT THIS CAN'T BE FOR 16-BIT REG
1441 21E52B  06500        LD     HL,CODE
1444 FE34    06510        CP     34H        ; IS IT 'ADD' INSTRUCTION?
1446 280C    06520        JR     Z,ADDINS   ; YES - SKIP ADDING ONE BYTE
1448 3AE42B  06530        LD     A,(IXIY)   ; IS IX/IY INVOLVED?
144B B7      06540        OR     A
144C 204A    06550        JR     NZ,SKWHAT  ; YES - NOT ALLOWED
144E 36ED    06560        LD     (HL),0EDH  ; ADD ED+
1450 23      06570        INC    HL
1451 DD340E  06580        INC    (IX+14)    ; INCREMENT NUMBER OF BYTES
1454 E5      06590 ADDINS PUSH   HL
1455 21E12B  06600        LD     HL,INS3    ; IN SECOND OPERAND...
;new page
1458 CD2E14  06610        CALL   KOJPAR     ; ...WHICH IS REGISTER PAIR
145B 213F1E  06620        LD     HL,TAB6-34H
145E 09      06630        ADD    HL,BC      ; CALCULATE MICROCODE
145F B6      06640        OR     (HL)       ; AND PUT IT IN CODE
1460 E1      06650        POP    HL
1461 77      06660        LD     (HL),A     ; PUT IN PLACE FOR CODES
1462 C9      06670        RET
             06680
1463 FE3E    06690 GRUPA6 CP     3EH        ; IS IT GROUP 6 (INC - DEC)
1465 3034    06700        JR     NC,GRUPA7  ; NO - GO FURTHER
1467 CD9014  06710        CALL   IF3SN      ; IF IT HAS OPER 2 THEN WHAT
146A CD2614  06720        CALL   PARREG     ; WHICH REGISTER OR REGISTER PAIR?
146D 57      06730        LD     D,A
146E 79      06740        LD     A,C
146F 1D      06750        DEC    E          ; E = NUMBER OF BIT/8; E=2 FOR 16-BIT
1470 280E    06760        JR     Z,BYTE1    ; IF E=1; THEN 8-BIT
1472 FE3C    06770        CP     3CH        ; 3CH = 'INC'
1474 2803    06780        JR     Z,INCJE1   ; SKIP 'DEC' PROCESSING
1476 3E0B    06790        LD     A,0BH      ; 'DEC' MICROCODE
1478 21      06800        DEFB   21H        ; 21H='LD HL,NN'; JUST SKIPS 2 BYTES
1479 3E03    06810 INCJE1 LD     A,3        ; 3 = 'DEC'
147B B2      06820        OR     D          ; INCLUDE IN MICROCODE
147C 32E52B  06830 CODRET LD     (CODE),A
147F C9      06840        RET
             06850
1480 FE3C    06860 BYTE1  CP     3CH        ; 3CH = 'INC' TOKEN
1482 2803    06870        JR     Z,INCJE    ; SKIP 'DEC' PROCESSING
1484 3E05    06880        LD     A,5        ; 5 = 'DEC' MICROCODE
1486 21      06890        DEFB   21H        ; 21H='LD HL,NN'; JUST SKIPS 2 BYTES
1487 3E04    06900 INCJE  LD     A,4        ; 4 = 'INC' MICROCODE
1489 B2      06910        OR     D
148A 21DE2B  06920        LD     HL,INS2
148D C30314  06930        JP     ADJUST     ; PUT IN PLACE FOR CODES
             06940
1490 21DE2B  06950 IF3SN  LD     HL,INS2
1493 3AE12B  06960 TEST3  LD     A,(INS3)   ; IF THERE EXISTS SECOND OPERAND
1496 B7      06970        OR     A
1497 C8      06980        RET    Z
1498 C32D19  06990 SKWHAT JP     WHATHL     ; ... THEN GO TO WHAT
             07000
149B FE3F    07010 GRUPA7 CP     3FH        ; 7. GROUP (LD/EX)
149D CA6115  07020        JP     Z,EXJE     ; IF IT'S JFN (EX) SKIP
14A0 D2B815  07030        JP     NC,GRUPA8  ; IF IT'S >3FH GO FURTHER
14A3 060B    07040        LD     B,11       ; 11 CASES FOR TESTING
14A5 21A11E  07050        LD     HL,TESTAR  ; 'LD' TABLE
14A8 CD7515  07060        CALL   TEST       ; FIND COINCIDENT CASE
14AB 202D    07070        JR     NZ,NFOU1   ; NOT SPECIAL CASE - SKIP
14AD FE03    07080        CP     3          ; IS IT LD A,(NN) OR (NN),A?
14AF 301A    07090        JR     NC,NOTNN   ; NEITHER ONE NOR OTHER - SKIP
14B1 21DF2B  07100        LD     HL,INS2+1  ; GET OPER1
14B4 3D      07110        DEC    A
14B5 2803    07120        JR     Z,NNA      ; REMAINING OPER BECAUSE IT'S LD (NN)
14B7 21E22B  07130        LD     HL,INS3+1  ; OPER2
14BA DD360E03 07140 NNA   LD     (IX+14),3  ; 3 BYTES INSTRUCTION LENGTH
14BE 7E      07150        LD     A,(HL)
14BF 32E62B  07160        LD     (CODE+1),A ; LOW BYTE OF NUMERIC FIELD NN
14C2 23      07170        INC    HL
14C3 7E      07180        LD     A,(HL)
14C4 32E72B  07190        LD     (CODE+2),A ; HIGH BYTE
14C7 DD700A  07200 CODE6  LD     (IX+10),B  ; 32H OR 3AH (LD (NN),A OR LD A,(NN))
14CA C9      07210        RET
             07220
14CB FE08    07230 NOTNN  CP     8          ; IS IT LD A,I/I,A/A,R/R,A
14CD 21E52B  07240        LD     HL,CODE
14D0 3806    07250        JR     C,SIMPLE   ; NONE OF THESE
14D2 36ED    07260        LD     (HL),0EDH  ; FIRST BYTE OF CODE IS 0EDH
; more pages to be added
